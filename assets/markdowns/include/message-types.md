Chunk Size:

* メッセージ種類 ID: 1
* メッセージ長: 4 bytes
* 入力内容:
  * チャンク**データ**を一度に受け取るデータ量. (チャンク全体を指していないことに注意)
  * 最上位ビットは 0 で**なければならない**.
  * 4 bytes が確保されているが実際のチャンクデータの長さの値は高々 3 bytes であるため, 0xFFFFFF よりも大きくなることはまずない.
  * 仕様書では少なくとも 128 (bytes) である**べき**で, かつ少なくとも 1 (byte) で**なければならない**としている.
  * 一方でデフォルト値を 128 (bytes) としており, 多くの製品はこれに従っている.

公式ドキュメントでは Set Chunk Size と呼んでいるが, 既存 OSS 製品では Chunk Size と呼ばれているため, ソースコードとの統一性のために本稿でも Chunk Size と呼ぶことにする.

Abort:

* メッセージ種類 ID: 2
* メッセージ長: 4 bytes
* 入力内容:
  * 送受信を中止する対象のチャンクストリーム ID.
  * 何らかの理由でチャンクストリームを強制的に閉じなければならない時に当該チャンクデータにチャンクストリーム ID を入力して終了を伝える.

Bytes Read:

* メッセージ種類 ID: 3
* メッセージ長: 4 bytes
* 入力内容:
  * これまでに受信したデータ量.
  * サーバ側もクライアント側も, 受信したデータ量が事前に通知しているウィンドウサイズに等しくなった場合に当該チャンクデータにそのデータ量を入力して送信し**なければならない**.
  * ウィンドウサイズは相手側から当該チャンクデータを受信せずに送れるデータ量の最大値である.

公式ドキュメントでは Acknowledgement と呼んでいるが既存 OSS 製品では Bytes Read と呼ばれているため, ソースコードとの統一性のために本稿でも Bytes Read と呼ぶことにする.

User Control(Official, FFmpeg, OBS) / Ping(Red5):

* メッセージ種類 ID: 4
* メッセージ長: 可変
* 入力内容:
  * 主にメッセージストリーム ID だが, どの種類のイベントを入力するかによって具体的な内容に違いがある.
  * 詳細は [User Control Message の種類とデータ](#user-control-message-の種類とデータ)を参照.

本稿では, 受信したデータと同様の性質のものをクライアントに返送するという性質から, 当該チャンクデータには Ping/Pong の名称を採用する.

Window Acknowledgement Size (Official, FFmpeg) / Server Bandwidth (Red5, OBS):

* メッセージ種類 ID: 5
* メッセージ長: 4 bytes
* 入力内容:
  * サーバ側が Bytes Read チャンクを送信せずに送れる最大のデータ量.
  * つまりサーバ側の回線帯域である.
  * 多くの場合, 3 Mbps 前後をデフォルト値とされているが変更可能である.

Set Peer Bandwidth (Official, FFmpeg) / Client Bandwidth (Red5, OBS):

* メッセージ種類 ID: 6
* メッセージ長: 5 bytes
* 入力内容:
  * クライアント側が Bytes Read チャンク送信せずに送れる最大のデータ量 (4 bytes).
  * つまりクライアント側の回線帯域である.
  * 多くの場合, 3 Mbps 前後をデフォルト値とされているがこれも変更可能である.
  * 最後の 1 byte には帯域の調整方法を入力する.
    * 0(Hard): クライアント側はこのチャンクで指定された帯域に合わせる**べきである**.
    * 1(Soft): 新しく指定された帯域と直前に指定されている帯域の内, どちらか小さい方を選ぶ**べきである**.
    * 2(Dynamic): 直前の帯域幅の制限が 0(Hard) なら Hard にする. そうでなければこのメセージを無視する.

Audio

* メッセージ種類 ID: 8
* メッセージ長: 可変
* 入力内容:
  * 音声データ.
  * 可変長の生のバイト列が入力される.
  * 詳細は後日記載.

Video:

* メッセージ種類 ID: 9
* メッセージ長: 可変
* 入力内容:
  * 映像データ.
  * 以下同上.
  * 詳細は後日記載.

Data(Official) / Notify(FFmpeg, Red5) / Info(OBS):

* メッセージ種類 ID: 15(AMF3) / 18(AMF0)
* メッセージ長: 可変
* 入力内容:
  * チャンク(主に映像・音声)のメタデータ.

Shared Object:

* メッセージ種類 ID: 16(AMF3) / 19(AMF0)
* メッセージ長: 可変
* 入力内容:
  * 名前と値のペアのコレクション.
  * 複数のクライアント間やインスタンス間で同期をとるための Flash Objectである.
  * 既存の OSS 製品では Red5 のみが実装しているが, 具体的なデータ構造を特定できないため詳細は割愛する.

Invoke:

* メッセージ種類 ID: 17(AMF3) / 20(AMF0)
* メッセージ長: 可変
* 入力内容:
  * クライアントとサーバの間で映像の送受信の際に必要になるメッセージを入力する.
  * 映像・音声データの送受信より前に送受信される基本的なメッセージはすべてこの Invoke チャンクを介して行われる.

公式ドキュメントでは Command と呼んでいるが既存 OSS 製品では Invoke と呼ばれているため, ソースコードとの統一性のために本稿でも Invoke と呼ぶことにする.

MetaData:

* メッセージ種類ID: 22
* メッセージ長: 可変
* 入力内容:
  * 音声や映像に関するメタデータ.
  * 詳細は [Metadata の構造](#metadata-の構造)を参照.

公式ドキュメントでは Aggregate と呼んでいるが既存 OSS 製品では Metadata と呼ばれているため, ソースコードとの統一性のために本稿でも MetaData と呼ぶことにする.
